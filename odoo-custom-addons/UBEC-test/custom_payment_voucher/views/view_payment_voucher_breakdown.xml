<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <record id="view_payment_voucher_breakdown_tree" model="ir.ui.view">
        <field name="name">payment.voucher.breakdown.tree</field>
        <field name="model">payment.voucher.breakdown</field>
        <field name="arch" type="xml">
            <list decoration-success="state == 'done'" decoration-danger="state =='cancel'" create="false">
                <field name="name" string="Name"/>
                <field name="voucher_id" string="Name"/>
                <field name="payment_date" string="Payment Date"/>
                <field name="partner_id" string="Customer"/>
                <field name="amount_to_paid" string="Amount To Be Paid"/>
                <field name="state"/>
            </list>
        </field>
    </record>

    <record id="view_payment_voucher_breakdown_form" model="ir.ui.view">
        <field name="name">payment.voucher.breakdown.form</field>
        <field name="model">payment.voucher.breakdown</field>
        <field name="arch" type="xml">
            <form string="Vouchers Details">
                <header string="Voucher Details">

                    <button name="send_email" string="Send Email" type="object"
                            invisible="state != 'draft'"
                            class="btn-primary"/>
                    <button name="print_voucher" string="Print" type="object"
                            invisible="state in ['draft','prepared', 'checked', 'authorized', 'certified', 'funds_budget', 'audit', 'cash_office','cancel','rejected']"
                            class="btn-primary"/>

                    <button name="action_check" string="Check" type="object"
                            groups="custom_payment_voucher.group_payment_voucher_checker"
                            invisible="state != 'prepared'" class="btn-primary"/>

                    <button name="action_authorize" string="Authorize" type="object"
                            groups="custom_payment_voucher.group_payment_voucher_authorizer"
                            invisible="state != 'checked'" class="btn-primary"/>

                    <button name="action_certify" string="Certify" type="object"
                            groups="custom_payment_voucher.group_payment_voucher_certifier"
                            invisible="state != 'authorized'" class="btn-primary"/>

                    <button name="action_funds_budget" string="Funds Budget" type="object"
                            groups="custom_payment_voucher.group_payment_voucher_funds_budget"
                            invisible="state != 'certified'" class="btn-primary"/>

                    <button name="action_audit" string="Audit" type="object"
                            groups="custom_payment_voucher.group_payment_voucher_auditor"
                            invisible="state != 'funds_budget'" class="btn-primary"/>

                    <button name="action_cash_office" string="Cash Office" type="object"
                            groups="custom_payment_voucher.group_payment_voucher_cash_office"
                            invisible="state != 'audit'" class="btn-primary"/>

                    <button name="action_paid" string="Post" type="object" class="oe_highlight"
                            groups="custom_payment_voucher.group_payment_voucher_cash_office"
                            invisible="state != 'cash_office'"/>

                    <button name="action_reject" string="Reject" type="object" Class="btn-danger"
                            invisible="state in ['draft','done', 'rejected','cancel']"/>

                    <!-- Cancel button, visible for any state except 'done' and 'rejected' -->
                    <button name="action_cancel" string="Cancel" type="object" Class="btn-danger"
                            invisible="state in ['draft','prepared', 'checked', 'authorized', 'certified', 'funds_budget', 'audit', 'cash_office','cancel','rejected']"/>

                    <!-- State bar with visibility for each state -->
                    <field name="state" widget="statusbar"
                           statusbar_visible="draft,prepared,checked,authorized,certified,funds_budget,audit,cash_office,done,rejected,cancel"/>
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button name="view_journal_entries" type="object" icon="fa-dollar" string="Journal Items"
                                invisible="state not in ('done')">
                            <div class="o_stat_info">
                                <field name="journal_count" widget="statinfo"/>
                            </div>
                        </button>
                    </div>
                    <widget name="web_ribbon" text="Checked" invisible="state != 'checked'" bg_color="text-bg-info"/>
                    <widget name="web_ribbon" text="Authorized" invisible="state != 'authorized'" bg_color="text-bg-info"/>
                    <widget name="web_ribbon" text="Certified" invisible="state != 'certified'" bg_color="text-bg-info"/>
                    <widget name="web_ribbon" text="Funds Budget" invisible="state != 'funds_budget'" bg_color="text-bg-info"/>
                    <widget name="web_ribbon" text="Audit" invisible="state != 'audit'" bg_color="text-bg-info"/>
                    <widget name="web_ribbon" text="Cash Office" invisible="state != 'cash_office'" bg_color="text-bg-info"/>
                    <widget name="web_ribbon" text="Paid" invisible="state != 'done'" bg_color="text-bg-info"/>
                    <widget name="web_ribbon" text="Rejected" invisible="state != 'rejected'" bg_color="text-bg-danger"/>
                    <widget name="web_ribbon" text="Cancel" invisible="state != 'cancel'" bg_color="text-bg-warning"/>

                    <div class="oe_title mb24">
                        <h1>
                            <field name="name" placeholder="Payment Voucher Number"/>
                        </h1>
                    </div>
                    <group>
                        <group>
                            <field name="payment_date" readonly="is_locked == True"/>
                            <field name="voucher_id" readonly="1"
                                   options="{'no_create': True, 'no_open': True}"/>
                            <field name="partner_id" placeholder="Select Partner"
                                   readonly="1"
                                   options="{'no_create': True, 'no_open': True}"/>
                            <field name="journal_id" placeholder="Select Journal"
                                   readonly="1"
                                   options="{'no_create': True, 'no_open': True}"/>
                            <field name="expense_account_id" options="{'no_create': True, 'no_open': True}"
                                   placeholder="Select Expenses Account" readonly="1"/>
                        </group>
                        <group>
                            <field name="partner_balance_credits" readonly="1"/>
                            <field name="amount_to_paid" readonly="is_locked == True" placeholder="Enter Amount"/>
                            <field name="currency_id" options="{'no_create': True, 'no_open': True}"/>
                            <field name="journal_entry_id" readonly="1"/>
                            <field name="voucher_ref" readonly="1"/>
                            <field name="file_no" readonly="1"/>


                        </group>
                    </group>
                    <notebook>
                        <page string="Voucher Lines">
                            <field name="breakdown_line_ids">
                                <list editable="bottom">

                                    <field name="account_id" force_save="1" readonly="parent.is_locked == True" options="{'no_create': True, 'no_open': True}"/>
                                    <field name="account_code"/>
                                    <field name="description" force_save="1" readonly="parent.is_locked == True"/>
                                    <field name="analytic_account_id" force_save="1" readonly="parent.is_locked == True" options="{'no_create': True, 'no_open': True}"/>
                                    <field name="currency_id" force_save="1" readonly="parent.is_locked == True" options="{'no_create': True, 'no_open': True}"/>
                                    <field name="debit_amount" force_save="1" sum="debit_amount" readonly="parent.is_locked == True"/>
                                    <field name="credit_amount" force_save="1" sum="credit_amount" readonly="parent.is_locked == True"/>
                                </list>
                            </field>
                        </page>
                        <page string="Approval Log" readonly="1">
                            <field name="approval_log_ids">
                                <list open="0" create="0" delete="0">
                                    <field name="date"/>
                                    <field name="action"/>
                                    <field name="comment"/>
                                    <field name="user_id"/>
                                </list>
                            </field>
                        </page>
                        <page string="Additional Information">
                            <group>
                                <group>
                                    <field name="company_id"/>
                                    <field name="currency_id"/>
                                    <field name="is_locked" force_save="1" readonly="1"/>
                                </group>
                                <group>
                                    <field name="prepared_by"/>
                                    <field name="cancelled_by"/>
                                </group>
                            </group>
                        </page>
                    </notebook>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

    <record id="action_payment_breakdown_voucher" model="ir.actions.act_window">
        <field name="name">Vouchers Details</field>
        <field name="res_model">payment.voucher.breakdown</field>
        <field name="view_mode">list,form</field>
    </record>

    <!-- For creating Menu for VendorPayment Voucher -->
    <menuitem
            id="menu_payment_breakdown_vendor_voucher"
            name="Vouchers Details"
            sequence="20"
            parent="custom_payment_voucher.main_payment_voucher"
            action="custom_payment_voucher.action_payment_breakdown_voucher"/>

</odoo>